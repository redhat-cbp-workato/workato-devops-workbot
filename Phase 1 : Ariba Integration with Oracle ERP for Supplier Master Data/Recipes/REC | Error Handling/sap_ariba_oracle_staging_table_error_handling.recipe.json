{
  "name": "SAP ARIBA | Oracle Staging Table Error Handling",
  "description": "",
  "version": 3,
  "private": true,
  "concurrency": 1,
  "code": {
    "number": 0,
    "provider": "oracle",
    "name": "updated_rows_batch",
    "as": "3fa25d59",
    "keyword": "trigger",
    "dynamicPickListSelection": {
      "primary_key": "ARIBA_VENDOR_ID",
      "sort_column": "CREATION_DATE",
      "output_columns": [
        {
          "label": "INTERFACE_ID",
          "value": "INTERFACE_ID"
        },
        {
          "label": "RECORD_METHOD",
          "value": "RECORD_METHOD"
        },
        {
          "label": "VENDOR_NAME",
          "value": "VENDOR_NAME"
        },
        {
          "label": "SOURCE",
          "value": "SOURCE"
        },
        {
          "label": "VENDOR_SITE_CODE",
          "value": "VENDOR_SITE_CODE"
        },
        {
          "label": "VENDOR_NAME_ALT",
          "value": "VENDOR_NAME_ALT"
        },
        {
          "label": "DUNS_NUMBER",
          "value": "DUNS_NUMBER"
        },
        {
          "label": "EMAIL_ADDRESS",
          "value": "EMAIL_ADDRESS"
        },
        {
          "label": "OU_NAME",
          "value": "OU_NAME"
        },
        {
          "label": "VENDOR_ID",
          "value": "VENDOR_ID"
        },
        {
          "label": "INTERFACE_STATUS",
          "value": "INTERFACE_STATUS"
        },
        {
          "label": "INTERFACE_ERROR",
          "value": "INTERFACE_ERROR"
        },
        {
          "label": "VERIFIED",
          "value": "VERIFIED"
        },
        {
          "label": "ARIBA_VENDOR_ID",
          "value": "ARIBA_VENDOR_ID"
        },
        {
          "label": "REQUEST_ID",
          "value": "REQUEST_ID"
        }
      ]
    },
    "toggleCfg": {
      "table": false,
      "___poll_interval": true
    },
    "input": {
      "table": "XXRHFIN.XXRH_SUPPLIER_IMPORT_ALTER_STG",
      "batch_size": "100",
      "primary_key": "ARIBA_VENDOR_ID",
      "sort_column": "CREATION_DATE",
      "___poll_interval": "1440",
      "where": "INTERFACE_STATUS = 'E' AND\nTRUNC(CREATION_DATE) >= TRUNC(SYSDATE - 2) ",
      "output_columns": "INTERFACE_ID\nRECORD_METHOD\nVENDOR_NAME\nSOURCE\nVENDOR_SITE_CODE\nVENDOR_NAME_ALT\nDUNS_NUMBER\nEMAIL_ADDRESS\nOU_NAME\nVENDOR_ID\nINTERFACE_STATUS\nINTERFACE_ERROR\nVERIFIED\nARIBA_VENDOR_ID\nREQUEST_ID"
    },
    "extended_output_schema": [
      {
        "label": "Rows",
        "name": "rows",
        "of": "object",
        "properties": [
          {
            "control_type": "text",
            "label": "ARIBA_VENDOR_ID",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "ARIBA_VENDOR_ID",
              "length": 100,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 100",
            "type": "string",
            "name": "ariba_vendor_id"
          },
          {
            "control_type": "date_time",
            "label": "CREATION_DATE",
            "render_input": "render_date_time_format",
            "parse_output": "parse_date_time_format",
            "details": {
              "primary_key": false,
              "data_type": "date",
              "column_name": "CREATION_DATE",
              "length": 0,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "date",
            "type": "date_time",
            "name": "creation_date"
          },
          {
            "control_type": "text",
            "label": "DUNS_NUMBER",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "DUNS_NUMBER",
              "length": 150,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 150",
            "type": "string",
            "name": "duns_number"
          },
          {
            "control_type": "text",
            "label": "EMAIL_ADDRESS",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "EMAIL_ADDRESS",
              "length": 2000,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 2000",
            "type": "string",
            "name": "email_address"
          },
          {
            "control_type": "text",
            "label": "INTERFACE_ERROR",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "INTERFACE_ERROR",
              "length": 4000,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 4000",
            "type": "string",
            "name": "interface_error"
          },
          {
            "control_type": "number",
            "label": "INTERFACE_ID",
            "parse_output": "parse_numeric_output",
            "details": {
              "primary_key": false,
              "data_type": "number",
              "column_name": "INTERFACE_ID",
              "length": 0,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "number",
            "type": "number",
            "name": "interface_id"
          },
          {
            "control_type": "text",
            "label": "INTERFACE_STATUS",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "INTERFACE_STATUS",
              "length": 1,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 1",
            "type": "string",
            "name": "interface_status"
          },
          {
            "control_type": "text",
            "label": "OU_NAME",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "OU_NAME",
              "length": 50,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 50",
            "type": "string",
            "name": "ou_name"
          },
          {
            "control_type": "text",
            "label": "RECORD_METHOD",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "RECORD_METHOD",
              "length": 10,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 10",
            "type": "string",
            "name": "record_method"
          },
          {
            "control_type": "number",
            "label": "REQUEST_ID",
            "parse_output": "parse_numeric_output",
            "details": {
              "primary_key": false,
              "data_type": "number",
              "column_name": "REQUEST_ID",
              "length": 0,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "number",
            "type": "number",
            "name": "request_id"
          },
          {
            "control_type": "text",
            "label": "SOURCE",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "SOURCE",
              "length": 100,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 100",
            "type": "string",
            "name": "source"
          },
          {
            "control_type": "number",
            "label": "VENDOR_ID",
            "parse_output": "parse_numeric_output",
            "details": {
              "primary_key": false,
              "data_type": "number",
              "column_name": "VENDOR_ID",
              "length": 0,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "number",
            "type": "number",
            "name": "vendor_id"
          },
          {
            "control_type": "text",
            "label": "VENDOR_NAME",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "VENDOR_NAME",
              "length": 240,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 240",
            "type": "string",
            "name": "vendor_name"
          },
          {
            "control_type": "text",
            "label": "VENDOR_NAME_ALT",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "VENDOR_NAME_ALT",
              "length": 320,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 320",
            "type": "string",
            "name": "vendor_name_alt"
          },
          {
            "control_type": "text",
            "label": "VENDOR_SITE_CODE",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "VENDOR_SITE_CODE",
              "length": 15,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 15",
            "type": "string",
            "name": "vendor_site_code"
          },
          {
            "control_type": "text",
            "label": "VERIFIED",
            "details": {
              "primary_key": false,
              "data_type": "varchar2",
              "column_name": "VERIFIED",
              "length": 1,
              "precision": null,
              "scale": null,
              "element_type": null
            },
            "optional": true,
            "hint": "varchar2, max length 1",
            "type": "string",
            "name": "verified"
          }
        ],
        "type": "array"
      },
      {
        "control_type": "text",
        "label": "First row ID",
        "name": "first_id",
        "optional": true,
        "type": "string"
      },
      {
        "control_type": "text",
        "label": "Last row ID",
        "name": "last_id",
        "optional": true,
        "type": "string"
      }
    ],
    "extended_input_schema": [
      {
        "control_type": "select",
        "extends_schema": true,
        "help": {
          "title": "Warning",
          "text": "A primary key or a column with unique constraint is recommended. This column should also be auto-incremental. Otherwise, trigger events may be missed."
        },
        "hint": "Select a unique key column to deduplicate rows. Performance can be improved if the selected unique key is indexed. <a href=\"https://docs.workato.com/connectors/oracle/introduction.html#unique-key\" target=\"_blank\">Learn more</a>",
        "label": "Unique key",
        "name": "primary_key",
        "pick_list": "columns_list",
        "pick_list_params": {
          "table": "table"
        },
        "type": "string"
      },
      {
        "control_type": "select",
        "help": {
          "title": "Warning",
          "text": "A column with high precision, up to milliseconds, is recommended. Otherwise, updates occurring within milliseconds may be missed."
        },
        "hint": "Select a column to identify updated rows. Only timestamp columns can be used as a sort column. <a href=\"https://docs.workato.com/connectors/oracle/introduction.html#sort-column\" target=\"_blank\">Learn more</a>",
        "label": "Sort column",
        "name": "sort_column",
        "pick_list": "timestamp_columns_list",
        "pick_list_params": {
          "table": "table"
        },
        "type": "string"
      },
      {
        "control_type": "text",
        "default": "100",
        "hint": "Batch size of rows to return in each job. Maximum batch size is 1000 and default is 100.",
        "label": "Batch size",
        "name": "batch_size",
        "parse_output": "integer_conversion",
        "type": "integer"
      },
      {
        "control_type": "multiselect",
        "delimiter": "\n",
        "extends_schema": true,
        "hint": "Choose columns to be returned from the selected table. Leave blank to return all columns.",
        "label": "Output columns",
        "name": "output_columns",
        "optional": true,
        "pick_list": "columns_list",
        "pick_list_params": {
          "table": "table"
        },
        "type": "string"
      },
      {
        "allow_formula_mode": true,
        "control_type": "code",
        "hint": "Rows matching this condition will be processed, e.g. <b>currency = 'USD'</b> (enclose strings in single quotes)",
        "label": "WHERE condition",
        "language": "sql",
        "name": "where",
        "optional": true,
        "sql_mime_type": "x-plsql",
        "sticky": true,
        "support_pills": true,
        "type": "string"
      }
    ],
    "visible_config_fields": [
      "table",
      "primary_key",
      "batch_size",
      "where",
      "___poll_interval",
      "sort_column",
      "output_columns"
    ],
    "block": [
      {
        "number": 1,
        "provider": "csv_parser",
        "name": "create_csv_lines",
        "as": "7d1e2204",
        "keyword": "action",
        "toggleCfg": {
          "create_header_line": true,
          "force_quotes": true
        },
        "input": {
          "create_header_line": "true",
          "column_separator": ",",
          "force_quotes": "false",
          "column_labels": "REQUEST_ID \nRECORD_METHOD\nINTERFACE_ID\nINTERFACE_STATUS \nINTERFACE_ERROR \nARIBA_VENDOR_ID\nVENDOR_ID\nVENDOR_NAME \nVENDOR_SITE_CODE\nOU_NAME\nDUNS_NUMBER\nCREATION_DATE",
          "lines": {
            "column_0": "=_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"request_id\"]}').presence.floor(0)",
            "column_1": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"record_method\"]}')}",
            "column_2": "=_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"interface_id\"]}').presence.floor(0)",
            "column_3": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"interface_status\"]}')}",
            "column_4": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"interface_error\"]}')}",
            "column_5": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"ariba_vendor_id\"]}')}",
            "column_6": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"vendor_id\"]}')}",
            "column_7": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"vendor_name\"]}')}",
            "column_8": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"vendor_site_code\"]}')}",
            "column_9": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"ou_name\"]}')}",
            "column_10": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"duns_number\"]}')}",
            "column_11": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\",{\"path_element_type\":\"current_item\"},\"creation_date\"]}')}",
            "____source": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"oracle\",\"line\":\"3fa25d59\",\"path\":[\"rows\"]}')}"
          }
        },
        "extended_input_schema": [
          {
            "hint": "Provide field mappings for the CSV data below.",
            "label": "CSV data lines",
            "name": "lines",
            "of": "object",
            "properties": [
              {
                "control_type": "text",
                "label": "REQUEST_ID",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_0"
              },
              {
                "control_type": "text",
                "label": "RECORD_METHOD",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_1"
              },
              {
                "control_type": "text",
                "label": "INTERFACE_ID",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_2"
              },
              {
                "control_type": "text",
                "label": "INTERFACE_STATUS",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_3"
              },
              {
                "control_type": "text",
                "label": "INTERFACE_ERROR",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_4"
              },
              {
                "control_type": "text",
                "label": "ARIBA_VENDOR_ID",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_5"
              },
              {
                "control_type": "text",
                "label": "VENDOR_ID",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_6"
              },
              {
                "control_type": "text",
                "label": "VENDOR_NAME",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_7"
              },
              {
                "control_type": "text",
                "label": "VENDOR_SITE_CODE",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_8"
              },
              {
                "control_type": "text",
                "label": "OU_NAME",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_9"
              },
              {
                "control_type": "text",
                "label": "DUNS_NUMBER",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_10"
              },
              {
                "control_type": "text",
                "label": "CREATION_DATE",
                "optional": true,
                "sticky": true,
                "type": "string",
                "name": "column_11"
              }
            ],
            "type": "array"
          }
        ],
        "uuid": "5d2585bb-e447-4a54-b2c2-dfe3b82fd038"
      },
      {
        "number": 2,
        "provider": "workato_files",
        "name": "store_file",
        "as": "906538c0",
        "keyword": "action",
        "dynamicPickListSelection": {
          "file_path": {
            "ids": [
              "/",
              "/S2PR2R",
              "/S2PR2R/SAPARIBA"
            ],
            "titles": [
              "Root directory",
              "S2PR2R",
              "SAPARIBA"
            ]
          }
        },
        "toggleCfg": {
          "is_csv_file": true,
          "overwrite": true,
          "csv_has_header": true,
          "file_path": true
        },
        "input": {
          "is_csv_file": "true",
          "schema_type": "auto",
          "csv_has_header": "true",
          "csv_delimiter": "comma",
          "csv_quote": "double",
          "encoding": "UTF-8",
          "overwrite": "true",
          "content": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"csv_parser\",\"line\":\"7d1e2204\",\"path\":[\"csv_lines\"]}')}",
          "file_path": "/S2PR2R/SAPARIBA",
          "file_name": "=(now.to_date).strftime('%d-%m-%Y') + \" Error Records.csv\""
        },
        "uuid": "b8122c58-3170-416a-a49c-5e60c3c5ec2b"
      },
      {
        "number": 3,
        "provider": "workato_recipe_function",
        "name": "call_recipe_async",
        "as": "1debb2c3",
        "keyword": "action",
        "dynamicPickListSelection": {
          "flow_id": "SAP ARIBA | Error Handling Recipe"
        },
        "input": {
          "flow_id": {
            "zip_name": "Phase 1 - Ariba - Integration Project/Recipe/REC | AribaToOracle/Error Handling/sap_ariba_error_handling_recipe.recipe.json",
            "name": "SAP ARIBA | Error Handling Recipe",
            "folder": "Phase 1 - Ariba - Integration Project/Recipe/REC | AribaToOracle/Error Handling",
            "folder_full_path": "Home/S2P R2R GET Delivery - Development/Phase 1 - Ariba - Integration Project/Recipe/REC | AribaToOracle/Error Handling"
          },
          "parameters": {
            "recipe_name": "#{_dp('{\"pill_type\":\"job_context\",\"path\":[\"recipe_name\"]}')}",
            "recipe_url": "#{_dp('{\"pill_type\":\"job_context\",\"path\":[\"recipe_url\"]}')}",
            "affected_oracle_table_name": "XXRHFIN.XXRH_SUPPLIER_IMPORT_ALTER_STG",
            "job_link": "#{_dp('{\"pill_type\":\"job_context\",\"path\":[\"job_url\"]}')}",
            "file_name": "#{_dp('{\"pill_type\":\"output\",\"provider\":\"workato_files\",\"line\":\"906538c0\",\"path\":[\"name\"]}')}"
          }
        },
        "extended_input_schema": [
          {
            "label": "Parameters",
            "name": "parameters",
            "properties": [
              {
                "control_type": "text",
                "label": "recipe_name",
                "name": "recipe_name",
                "type": "string",
                "optional": true
              },
              {
                "control_type": "text",
                "label": "recipe_url",
                "name": "recipe_url",
                "type": "string",
                "optional": true
              },
              {
                "control_type": "integer",
                "label": "error_step_no",
                "parse_output": "integer_conversion",
                "name": "error_step_no",
                "type": "integer",
                "optional": true,
                "render_input": "integer_conversion"
              },
              {
                "control_type": "integer",
                "label": "error_code",
                "parse_output": "integer_conversion",
                "name": "error_code",
                "type": "integer",
                "optional": true,
                "render_input": "integer_conversion"
              },
              {
                "control_type": "text",
                "label": "error_message",
                "name": "error_message",
                "type": "string",
                "optional": true
              },
              {
                "control_type": "text",
                "label": "affected_oracle_table_name",
                "name": "affected_oracle_table_name",
                "type": "string",
                "optional": true
              },
              {
                "control_type": "text",
                "label": "job_link",
                "name": "job_link",
                "type": "string",
                "optional": true
              },
              {
                "control_type": "date_time",
                "label": "job_failed_at",
                "render_input": "date_time_conversion",
                "parse_output": "date_time_conversion",
                "name": "job_failed_at",
                "type": "date_time",
                "optional": true
              },
              {
                "control_type": "text",
                "label": "file_name",
                "name": "file_name",
                "type": "string",
                "optional": true
              }
            ],
            "type": "object"
          }
        ],
        "visible_config_fields": [
          "flow_id",
          "parameters.recipe_name",
          "parameters.recipe_url",
          "parameters.error_step_no",
          "parameters.error_code",
          "parameters.error_message",
          "parameters.affected_oracle_table_name",
          "parameters.job_link",
          "parameters.job_failed_at",
          "parameters.file_name"
        ],
        "uuid": "8e39fcb4-5810-40cf-a23e-e70dfd4f09aa",
        "skip": false
      }
    ],
    "uuid": "9d0584cf-564b-4363-9d18-b0ccb3ac2178"
  },
  "config": [
    {
      "keyword": "application",
      "provider": "oracle",
      "skip_validation": false,
      "account_id": {
        "zip_name": "Phase 1 : Ariba Integration with Oracle ERP for Supplier Master Data/Connection/s2p_con_qa_xxrhfin.connection.json",
        "name": "S2P | CON | QA |Â XXRHFIN",
        "folder": "Phase 1 : Ariba Integration with Oracle ERP for Supplier Master Data/Connection"
      }
    },
    {
      "keyword": "application",
      "provider": "workato_recipe_function",
      "skip_validation": false,
      "account_id": null
    },
    {
      "keyword": "application",
      "provider": "csv_parser",
      "skip_validation": false,
      "account_id": null
    },
    {
      "keyword": "application",
      "provider": "workato_files",
      "skip_validation": false,
      "account_id": null
    }
  ],
  "tags": [
    "QA"
  ]
}